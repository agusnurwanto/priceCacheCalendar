var expect = require('chai').expect;
var fs = require('fs');
var Sriwijaya = require('../index')('sriwijaya');
var mockBody = {dep_date: "20+01+2015", ori: 'cgk', dst: 'sub'};
var mockDataSriwijaya = fs.readFileSync('./sr.html', 'utf8');
// var mockDataSriwijaya = '';
var debug       = require('debug')('raabbajam:priceCacheCalendar:sriwijayaspec');
// var mockDataSriwijaya = {departure: {flights: [[{seats: [{class: "c", available: 1}, {class: "y", available: 1}, {class: "L", available: 1} ] } ], [{seats: [{class: "c", available: 1}, {class: "y", available: 1}, {class: "L", available: 1} ] } ], [{seats: [{class: "c", available: 1}, {class: "y", available: 1}, {class: "L", available: 1} ] } ], ] } }
describe('Price Generator for Sriwijaya', function () {
	this.timeout(10000);
	/*it('should extend base', function (next) {
		var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
		expect(sriwijaya.name).to.equal('sriwijaya');
		next();
	});
	it('should return cache', function (next) {
		var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
		sriwijaya.getCache()
			.then(function () {
				expect(sriwijaya.cache[mockBody.ori.toLowerCase()+mockBody.dst.toLowerCase()]).to.exist;
				console.log(sriwijaya.cache);
				next();
			})
			.catch(function (err) {
				next(err);
			});
	});
	it('should loop get all routes', function (next) {
		var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
		var routes = sriwijaya.getAllRoutes();
		console.log(routes);
		expect(routes.length).gt(0);
		next();
	});
	it('should get all routes cache', function (next) {
		var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
		var routes = sriwijaya.getAllRoutes();
		sriwijaya.getAllCaches(routes)
			.then(function () {
				console.log(sriwijaya.cache);
				expect(sriwijaya.cache).not.eq({});
				next();
			})
			.catch(function (err) {
				next(err);
			});
	});
	it('should merge all cache', function (next) {
		var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
		var routes = sriwijaya.getAllRoutes();
		sriwijaya.getAllCaches(routes)
			.then(sriwijaya.mergeCache.bind(sriwijaya))
			.then(function (res) {
				// console.log(JSON.stringify(sriwijaya._scrape, null, 2));
				console.log(JSON.stringify(res, null, 2));
				console.log(sriwijaya.cache);
				next();
			})
			.catch(function (err) {
				next(err);
			});
	});
	it('should compare with db and insert to db if cheaper, for all lowest price', function (next) {
		var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
		var routes = sriwijaya.getAllRoutes();
		sriwijaya.getAllCaches(routes)
			.then(sriwijaya.mergeCache.bind(sriwijaya))
			.then(sriwijaya.insertAllLowest.bind(sriwijaya))
			.then(function (res) {
				fs.writeFileSync('./sr2.html', sriwijaya._scrape);
				next();
			})
			.catch(function (err) {
				next(err);
			});
	});*/
});

describe('Cache prices for Sriwijaya', function() {
	this.timeout(80000);
	/*describe('getCheapestInRow, getAllCheapest', function () {
		{//init
			var row = {"code_flight": {"1": "SJ 021", "2": "SJ 256"}, "depart": {"1": "PDG 13:50", "2": "CGK 18:35"}, "arrive": {"1": "CGK 15:35", "2": "SUB 19:50"}, "stop": {}, "O": ["<span class=\"classLetterCode\">O</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131358,2617385:O:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">883</span>"], "U": ["<span class=\"classLetterCode\">U</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131357,2617370:U:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">993</span>"], "X": ["<span class=\"classLetterCode\">X</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131362,2617376:X:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,092</span>"], "E": ["<span class=\"classLetterCode\">E</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131351,2617384:E:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,202</span>"], "G": ["<span class=\"classLetterCode\">G</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131344,2617380:G:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,323</span>"], "V": ["<span class=\"classLetterCode\">V</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131343,2617383:V:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,444</span>"], "T": ["<span class=\"classLetterCode\">T</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131350,2617372:T:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,554</span>"], "Q": ["<span class=\"classLetterCode\">Q</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131342,2617375:Q:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,664</span>"], "N": ["<span class=\"classLetterCode\">N</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131341,2617389:N:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,818</span>"], "M": ["<span class=\"classLetterCode\">M</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131349,2617373:M:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,972</span>"], "L": ["<span class=\"classLetterCode\">L</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131356,2617382:L:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,093</span>"], "K": ["<span class=\"classLetterCode\">K</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131361,2617371:K:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,170</span>"], "H": ["<span class=\"classLetterCode\">H</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131355,2617379:H:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,346</span>"], "B": ["<span class=\"classLetterCode\">B</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131360,2617388:B:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,379</span>"], "W": ["<span class=\"classLetterCode\">W</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131354,2617374:W:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,544</span>"], "S": ["<span class=\"classLetterCode\">S</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131359,2617387:S:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,599</span>"], "Y": ["<span class=\"classLetterCode\">Y</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131347,2617369:Y:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,610</span>"], "I": ["<span class=\"classLetterCode\">I</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131346,2617386:I:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">2,940</span>"], "D": ["<span class=\"classLetterCode\">D</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131352,2617368:D:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">3,380</span>"], "C": ["<span class=\"classLetterCode\">C (WL)</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131348,2617381:C:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">4,370</span>"], "detailFlight": {"1": "Padang, Minangkabau, Departure 13:50LT\r\n\t\tJakarta, Soekarno Hatta International Airport,  Arrival 15:35LT\r\n\t\tAC Type : 734 Y & C Config\t\t\r\n\r\n\t\tJakarta, Soekarno Hatta International Airport, Departure 18:35LT\r\n\t\tSurabaya, Juanda,  Arrival 19:50LT\r\n\t\tAC Type : 734 Y & C Config"} };
			var rows = [{"code_flight": {"1": "SJ 021", "2": "SJ 256"}, "depart": {"1": "PDG 13:50", "2": "CGK 18:35"}, "arrive": {"1": "CGK 15:35", "2": "SUB 19:50"}, "stop": {}, "O": ["<span class=\"classLetterCode\">O</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131358,2617385:O:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">883</span>"], "U": ["<span class=\"classLetterCode\">U</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131357,2617370:U:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">993</span>"], "X": ["<span class=\"classLetterCode\">X</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131362,2617376:X:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,092</span>"], "E": ["<span class=\"classLetterCode\">E</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131351,2617384:E:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,202</span>"], "G": ["<span class=\"classLetterCode\">G</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131344,2617380:G:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,323</span>"], "V": ["<span class=\"classLetterCode\">V</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131343,2617383:V:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,444</span>"], "T": ["<span class=\"classLetterCode\">T</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131350,2617372:T:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,554</span>"], "Q": ["<span class=\"classLetterCode\">Q</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131342,2617375:Q:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,664</span>"], "N": ["<span class=\"classLetterCode\">N</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131341,2617389:N:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,818</span>"], "M": ["<span class=\"classLetterCode\">M</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131349,2617373:M:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">1,972</span>"], "L": ["<span class=\"classLetterCode\">L</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131356,2617382:L:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,093</span>"], "K": ["<span class=\"classLetterCode\">K</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131361,2617371:K:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,170</span>"], "H": ["<span class=\"classLetterCode\">H</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131355,2617379:H:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,346</span>"], "B": ["<span class=\"classLetterCode\">B</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131360,2617388:B:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,379</span>"], "W": ["<span class=\"classLetterCode\">W</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131354,2617374:W:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,544</span>"], "S": ["<span class=\"classLetterCode\">S</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131359,2617387:S:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,599</span>"], "Y": ["<span class=\"classLetterCode\">Y</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131347,2617369:Y:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,610</span>"], "I": ["<span class=\"classLetterCode\">I</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131346,2617386:I:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">2,940</span>"], "D": ["<span class=\"classLetterCode\">D</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131352,2617368:D:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">3,380</span>"], "C": ["<span class=\"classLetterCode\">C (WL)</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131348,2617381:C:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">4,370</span>"], "detailFlight": {"1": "Padang, Minangkabau, Departure 13:50LT\r\n\t\tJakarta, Soekarno Hatta International Airport,  Arrival 15:35LT\r\n\t\tAC Type : 734 Y & C Config\t\t\r\n\r\n\t\tJakarta, Soekarno Hatta International Airport, Departure 18:35LT\r\n\t\tSurabaya, Juanda,  Arrival 19:50LT\r\n\t\tAC Type : 734 Y & C Config"} }, {"code_flight": {"1": "SJ 021", "2": "SJ 234"}, "depart": {"1": "PDG 13:50", "2": "CGK 18:30"}, "arrive": {"1": "CGK 15:35", "2": "SUB 21:00"}, "stop": {"1": "1Stops"}, "O": ["<span class=\"classLetterCode\">O</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131358,2510025:O:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">883</span>"], "U": ["<span class=\"classLetterCode\">U</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131357,2510024:U:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">993</span>"], "X": ["<span class=\"classLetterCode\">X</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131362,2510029:X:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,092</span>"], "E": ["<span class=\"classLetterCode\">E</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131351,2510018:E:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,202</span>"], "G": ["<span class=\"classLetterCode\">G</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131344,2510011:G:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,323</span>"], "V": ["<span class=\"classLetterCode\">V</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131343,2510010:V:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,444</span>"], "T": ["<span class=\"classLetterCode\">T</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131350,2510017:T:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,554</span>"], "Q": ["<span class=\"classLetterCode\">Q</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131342,2510009:Q:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">1,664</span>"], "N": ["<span class=\"classLetterCode\">N</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131341,2510008:N:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(3)</span><span class=\"avcellFare\">1,818</span>"], "M": ["<span class=\"classLetterCode\">M</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131349,2510016:M:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(6)</span><span class=\"avcellFare\">1,972</span>"], "L": ["<span class=\"classLetterCode\">L</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131356,2510023:L:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,093</span>"], "K": ["<span class=\"classLetterCode\">K</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131361,2510028:K:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,170</span>"], "H": ["<span class=\"classLetterCode\">H</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131355,2510022:H:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,346</span>"], "B": ["<span class=\"classLetterCode\">B</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131360,2510027:B:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,379</span>"], "W": ["<span class=\"classLetterCode\">W</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131354,2510021:W:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,544</span>"], "S": ["<span class=\"classLetterCode\">S</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131359,2510026:S:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,599</span>"], "Y": ["<span class=\"classLetterCode\">Y</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131347,2510014:Y:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(9)</span><span class=\"avcellFare\">2,610</span>"], "I": ["<span class=\"classLetterCode\">I</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131346,2510013:I:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">2,940</span>"], "D": ["<span class=\"classLetterCode\">D</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" disabled=\"disabled\" type=\"radio\" value=\"131352,2510019:D:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">3,380</span>"], "C": ["<span class=\"classLetterCode\">C (WL)</span><input class=\"avcellRadio\" name=\"radioFrom\" id=\"radioFrom\" type=\"radio\" value=\"131348,2510015:C:C\" onclick=\"getVote(this.value, this.name, document.cek_harga2.extracover.checked, &apos;&apos;)\"><span class=\"availNumCode\">(0)</span><span class=\"avcellFare\">4,370</span>"], "detailFlight": {"1": "Padang, Minangkabau, Departure 13:50LT\r\n\t\tJakarta, Soekarno Hatta International Airport,  Arrival 15:35LT\r\n\t\tAC Type : 734 Y & C Config\t\t\r\n\r\n\t\t\tJakarta, Soekarno Hatta International Airport, Departure 18:30LT\r\n\t\t\t\r\n\t\t\tYogyakarta, Adi Sucipto,  Arrival 19:40LT\t\t\t\t, Departure 20:10LT\t\t\t\r\n\t\t\t\r\n\t\t\tSurabaya, Juanda,  Arrival 21:00LT\t\t\t\r\n\t\tAC Type : 735 Y & C CONFIG"} } ];
			var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
		}
		it('should return an array of object with ori, dst, class and flight property', function (next) {
			var cheapest = sriwijaya.getCheapestInRow(row);
			debug('cheapest',cheapest)
			expect(cheapest[0].class).to.eq("T");
			next();
		});
		it('should return an array cheapest class', function (next) {
			var flightClasses = sriwijaya.getAllCheapest(rows);
			debug('flightClasses',flightClasses);
			expect(Object.keys(flightClasses).length).to.gt(0);
			next();
		});
	});*/
	describe('merge', function() {
		it('should get all cheapest seat per row, get prices data from db or scrape if necessary and return it after merged', function (done) {
			var json = JSON.parse(fs.readFileSync('./srcp.json', 'utf8'));
			var sriwijaya = new Sriwijaya(mockBody, mockDataSriwijaya);
			sriwijaya.merge(json)
				.then(function (res) {
					// debug(res);
					fs.writeFileSync('./srcp2.json', JSON.stringify(res,null, 4));
					done();
				}, done);
		});
	});
});
